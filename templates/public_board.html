{% extends "base.html" %}
{% block content %}
<div style="display: flex; flex-direction: column; align-items: center; padding: 40px;">
  
  <form action="{{ url_for('add_post') }}" method="post" enctype="multipart/form-data">
    <textarea name="text" placeholder="Write something..." required></textarea><br>
    <input type="file" name="file"><br>
    <button type="submit">Post</button>
  </form>

  <hr style="margin: 40px 0; width: 100%; max-width: 600px;">

  <h2>Public Posts</h2>
  {% for post in posts %}
    <div class="post">
      <strong>{{ post.username }}</strong> <em>{{ post.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</em>
      <p>{{ post.text }}</p>

      {% if post.filename %}
        {% if post.filename.endswith(('jpg', 'jpeg', 'png', 'gif')) %}
          <img src="{{ url_for('static', filename='uploads/' + post.filename) }}" style="max-width:300px;">
        {% elif post.filename.endswith('mp4') %}
          <video controls style="max-width:300px;">
            <source src="{{ url_for('static', filename='uploads/' + post.filename) }}" type="video/mp4">
          </video>
        {% else %}
          <a href="{{ url_for('static', filename='uploads/' + post.filename) }}">Download {{ post.filename }}</a>
        {% endif %}
      {% endif %}
    </div>
    <hr>
  {% endfor %}
</div>
{% endblock %}
